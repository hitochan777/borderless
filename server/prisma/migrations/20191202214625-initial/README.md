# Migration `20191202214625-initial`

This migration has been generated by Otsuki Hitoshi at 12/2/2019, 9:46:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "lift"."Repliable" (
  "id" TEXT NOT NULL   ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."User" (
  "email" TEXT NOT NULL DEFAULT ''  ,
  "fluentLanguages" TEXT    ,
  "id" TEXT NOT NULL   ,
  "learningLanguages" TEXT    ,
  "uid" TEXT NOT NULL DEFAULT ''  ,
  "username" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Post" (
  "content" TEXT NOT NULL DEFAULT ''  ,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "language" INTEGER NOT NULL DEFAULT 0  ,
  "published" BOOLEAN NOT NULL DEFAULT false  ,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "user" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."Tweet" (
  "content" TEXT NOT NULL DEFAULT ''  ,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "inReplyTo" TEXT NOT NULL   REFERENCES "Repliable"(id) ON DELETE RESTRICT,
  "text" TEXT NOT NULL DEFAULT ''  ,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "user" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  PRIMARY KEY ("id")
);

CREATE TABLE "lift"."LineMarker" (
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "post" TEXT NOT NULL   REFERENCES "Post"(id) ON DELETE RESTRICT,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE UNIQUE INDEX "lift"."Repliable.id" ON "Repliable"("id")

CREATE UNIQUE INDEX "lift"."User.id" ON "User"("id")

CREATE UNIQUE INDEX "lift"."User.uid" ON "User"("uid")

CREATE UNIQUE INDEX "lift"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "lift"."Post.id" ON "Post"("id")

CREATE UNIQUE INDEX "lift"."Tweet.id" ON "Tweet"("id")

CREATE UNIQUE INDEX "lift"."LineMarker.id" ON "LineMarker"("id")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20191202214625-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,48 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:dev.db"
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+model Repliable {
+  id String @default(cuid()) @id @unique  
+}
+
+model User {
+  id                String  @default(cuid()) @id @unique
+  uid               String  @unique
+  email             String  @unique
+  username          String
+  fluentLanguages   String?
+  learningLanguages String?
+}
+
+model Post {
+  id        String  @default(cuid()) @id @unique
+  published Boolean
+  language  Int
+  content   String
+  user      User
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+}
+
+model Tweet {
+  id        String  @default(cuid()) @id @unique
+  content   String
+  inReplyTo Repliable
+  user      User
+  text      String
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+}
+
+model LineMarker {
+  id        String  @default(cuid()) @id @unique
+  post      Post
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20191202214625-initial)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20191202214625-initial'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
