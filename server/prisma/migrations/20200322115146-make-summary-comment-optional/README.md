# Migration `20200322115146-make-summary-comment-optional`

This migration has been generated by Otsuki Hitoshi at 3/22/2020, 11:51:46 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_CorrectionGroup" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "post" TEXT NOT NULL  ,
    "summaryComment" TEXT   ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "user" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("user") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("post") REFERENCES "Post"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("summaryComment") REFERENCES "Tweet"("id") ON DELETE SET NULL ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_CorrectionGroup" ("createdAt", "id", "post", "summaryComment", "updatedAt", "user") SELECT "createdAt", "id", "post", "summaryComment", "updatedAt", "user" FROM "quaint"."CorrectionGroup"

DROP TABLE "quaint"."CorrectionGroup";

ALTER TABLE "quaint"."new_CorrectionGroup" RENAME TO "CorrectionGroup";

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200321222957-add-correction-group..20200322115146-make-summary-comment-optional
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource development {
   provider = "sqlite"
-  url = "***"
+  url      = env("DB_URL")
 }
 generator photon {
   provider = "prisma-client-js"
@@ -53,16 +53,14 @@
 model CorrectionGroup {
   id        String  @default(cuid()) @id
   post      Post
   user      User
-  summaryComment Tweet
+  summaryComment Tweet?
   corrections Tweet[] @relation(name: "CorrectionTweets")
   createdAt DateTime  @default(now())
   updatedAt DateTime  @updatedAt
 }
-
-
 model LineMarker {
   id        String  @default(cuid()) @id
   post      Post
   createdAt DateTime  @default(now())
```


